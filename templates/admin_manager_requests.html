{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2 style="margin: 30px 0;">Manager Account Requests</h2>
    <table class="admin-table">
        <tr>
            <th>Time</th>
            <th>User</th>
            <th>Email</th>
            <th>Company Name</th>
            <th>Status</th>
            <th>Commission</th>
            <th>Action</th>
        </tr>
        {% for req in requests %}
        {% set user = user_map.get(req.user_id) %}
        <tr>
            <td>{{ req.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>{{ user.username if user else ('User #' ~ req.user_id) }}</td>
            <td>{{ user.email if user else '-' }}</td>
            <td>{{ req.company_name }}</td>
            <td>{{ req.status }}</td>
            <td>{{ ('%.2f'|format(req.commission_rate)) if req.commission_rate is not none else '-' }}</td>
            <td>
                {% if req.status == 'pending' %}
                <form method="POST" action="{{ url_for('admin.approve_manager_request', request_id=req.id) }}" style="display:inline-flex; gap:8px; align-items:center;">
                    <input type="number" step="0.01" min="0" max="100" name="commission_rate" value="5" style="width:90px;">
                    <button class="btn btn-primary" type="submit">Approve</button>
                </form>
                <form method="POST" action="{{ url_for('admin.reject_manager_request', request_id=req.id) }}" style="display:inline;">
                    <button class="btn btn-danger" type="submit">Reject</button>
                </form>
                {% else %}
                    -
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}
